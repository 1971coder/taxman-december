# Status Review — Taxman Manager (as of 2025-01-09)

## Implemented scope (verified)
- **Workspace + shared contracts:** The monorepo exposes shared Zod schemas in `packages/api-types`, covering company settings, clients, employees, rates, invoices, expenses, and BAS payloads that both the backend and frontend consume.【F:packages/api-types/src/index.ts†L1-L142】【F:app/backend/src/utils/zod-schemas.ts†L1-L34】
- **Settings & GST codes:** Express routes deliver `GET/PUT /api/settings` and `GET/POST /api/gst-codes`, while the React settings page wires forms for company profile and GST code capture.【F:app/backend/src/routes/settings.ts†L13-L35】【F:app/backend/src/routes/gst-codes.ts†L13-L28】【F:app/frontend/src/components/forms/gst-codes-card.tsx†L24-L122】
- **Clients, employees, and rate cards:** Back-end routers and rate-resolution service fulfil the Sprint 2–3 roadmap with client/employee CRUD, overlap-guarded client rates, and rate fallback logic to employee defaults.【F:app/backend/src/routes/clients.ts†L13-L41】【F:app/backend/src/routes/employees.ts†L13-L29】【F:app/backend/src/routes/client-rates.ts†L13-L93】【F:app/backend/src/services/rates.ts†L13-L44】
- **Invoicing with BAS-ready fields:** `POST /api/invoices` resolves rates, generates sequential numbers, stores optional `cashReceivedDate`, and is exercised by Vitest plus the React invoice form tests.【F:app/backend/src/routes/invoices.ts†L49-L179】【F:app/backend/src/__tests__/invoices.test.ts†L14-L70】【F:app/frontend/src/pages/invoices/__tests__/invoices.test.tsx†L1-L74】
- **Expenses & data import/export:** Expenses endpoints persist GST-split purchases, and `/api/data` provides CSV import/export plus SQLite backup/restore; the UI mirrors those flows with automated tests.【F:app/backend/src/routes/expenses.ts†L13-L40】【F:app/backend/src/routes/data-io.ts†L16-L481】【F:app/frontend/src/pages/expenses/index.tsx†L31-L185】【F:app/frontend/src/pages/data-io/index.tsx†L36-L200】【F:app/backend/src/__tests__/data-io.test.ts†L11-L120】
- **BAS reporting:** `/api/reports/bas` combines fiscal-period helpers and `computeBasSummary`, and the Reports page lets users recompute periods while surfacing (placeholder) exceptions with coverage in Vitest/UI tests.【F:app/backend/src/routes/reports.ts†L19-L92】【F:app/backend/src/services/bas/compute.ts†L25-L68】【F:app/backend/src/__tests__/bas-report.test.ts†L12-L143】【F:app/frontend/src/pages/reports/index.tsx†L17-L245】【F:app/frontend/src/pages/reports/__tests__/reports.test.tsx†L13-L83】
- **Frontend coverage:** Every primary screen (dashboard, clients, employees, invoices, expenses, reports, data I/O, settings) has a Testing Library suite that exercises fetch mocks and user flows, matching the context claims about UI automation.【F:app/frontend/src/pages/clients/__tests__/clients.test.tsx†L7-L54】【F:app/frontend/src/pages/employees/__tests__/employees.test.tsx†L1-L64】【F:app/frontend/src/pages/expenses/__tests__/expenses.test.tsx†L7-L55】【F:app/frontend/src/pages/reports/__tests__/reports.test.tsx†L13-L83】【F:app/frontend/src/pages/data-io/__tests__/data-io.test.tsx†L7-L44】【F:docs/context.md†L13-L16】

## Outstanding gaps vs. docs
- **GST code lifecycle:** The BRD/epics expect edit/deactivate flows (“Create/Edit; cannot delete if in use; deactivate allowed”), but the backend only exposes `POST` and the UI only supports adds, so updates/toggles remain to build.【F:docs/EPICS_AND_STORIES.md†L11-L15】【F:app/backend/src/routes/gst-codes.ts†L13-L28】【F:app/frontend/src/components/forms/gst-codes-card.tsx†L24-L122】
- **Supplier contact management:** Stories call for contacts CRUD (customers *and suppliers*) with search/export, yet only client-focused APIs/UI exist—no supplier model or search tooling is present.【F:docs/EPICS_AND_STORIES.md†L17-L21】【F:app/backend/src/routes/clients.ts†L13-L41】【F:app/frontend/src/pages/clients/index.tsx†L31-L155】
- **Invoice lifecycle beyond draft:** Architecture notes a `PUT /api/invoices/:id` path and the BRD promises PDF/email, credit notes, and manual receipts updating status; current routes lack update/send endpoints and the routes folder contains no receipts handlers.【F:docs/ARCHITECTURE.md†L72-L78】【F:docs/BRD.md†L27-L36】【5a9a96†L1-L2】【F:app/backend/src/routes/invoices.ts†L15-L179】
- **Exceptions + BAS export gating:** The roadmap and epics require exception detection and export gating (CSV/PDF), but `/api/reports/bas` always returns an empty exceptions array and the UI keeps “Export CSV” disabled with no download logic.【F:docs/ROADMAP.md†L32-L35】【F:docs/EPICS_AND_STORIES.md†L41-L47】【F:app/backend/src/routes/reports.ts†L55-L66】【F:app/frontend/src/pages/reports/index.tsx†L169-L244】
- **Receipts & cash tracking workflows:** BRD scope includes receipts and status changes, yet there is no API/UI for `receipts` despite schema tables existing, indicating unfinished work around BAS cash allocations.【F:docs/BRD.md†L33-L36】【F:app/backend/src/db/schema.ts†L62-L107】【5a9a96†L1-L2】
- **CSV detail exports & automated backups:** The context notes planned CSV detail exports, richer exceptions, and automated backup scheduling; current implementation only offers master/transaction summaries and manual backup triggers without scheduling.【F:docs/context.md†L18-L20】【F:docs/context.md†L94-L101】【F:app/backend/src/routes/data-io.ts†L16-L197】【F:app/frontend/src/pages/data-io/index.tsx†L36-L200】

## Recommended next steps
1. Extend GST code endpoints/UI with update & deactivate operations, enforcing “no delete when in use.”
2. Introduce supplier entities (or augment clients) plus search/export utilities to satisfy contacts stories.
3. Flesh out invoice lifecycle: add update/send endpoints, receipts APIs, and PDF/email stubs aligned to BRD expectations.
4. Implement BAS exception detectors with export gating and generate detailed CSV/PDF outputs.
5. Automate backup scheduling or reminders, and cover remaining backend paths (rate resolver, expenses) with Vitest to close context TODOs.【F:docs/context.md†L18-L20】
